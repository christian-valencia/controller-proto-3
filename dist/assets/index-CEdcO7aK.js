(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const u={LS_X:0,LS_Y:1,RS_X:2,RS_Y:3},T={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,VIEW:8,MENU:9,LS:10,RS:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16};class A{prev=new Map;now=new Map;deadzone=.18;triggerThreshold=.2;indexOfFirst=null;constructor(){console.log("ðŸŽ® GamepadManager initialized"),window.addEventListener("gamepadconnected",e=>{console.log("ðŸŽ® GAMEPAD CONNECTED:",e.gamepad.id),this.indexOfFirst===null&&(this.indexOfFirst=e.gamepad.index)}),window.addEventListener("gamepaddisconnected",e=>{console.log("ðŸŽ® GAMEPAD DISCONNECTED:",e.gamepad.id);const t=e.gamepad.index;this.indexOfFirst===t&&(this.indexOfFirst=null)})}first(){const e=navigator.getGamepads();for(const t of e)if(t)return t;return null}update(){this.prev=new Map(this.now),this.now.clear();const e=navigator.getGamepads();for(const t of e)t&&this.now.set(t.index,t)}btnValue(e,t){const s=e.buttons[T[t]];return s?t==="LT"||t==="RT"?s.value>=this.triggerThreshold?s.value:0:s.pressed?1:0:0}isDown(e,t=0){let s=this.now.get(t);if(!s){for(const[n,r]of this.now.entries())if(r){s=r;break}}return s?this.btnValue(s,e)>0:!1}justPressed(e,t=0){let s=this.now.get(t),n=this.prev.get(t);if(!s){for(const[d,a]of this.now.entries())if(a){s=a,n=this.prev.get(d);break}}if(!s)return!1;const r=this.btnValue(s,e)>0,o=n?this.btnValue(n,e)>0:!1;return r&&!o}justReleased(e,t=0){let s=this.now.get(t),n=this.prev.get(t);if(!s){for(const[d,a]of this.now.entries())if(a){s=a,n=this.prev.get(d);break}}if(!s)return!1;const r=this.btnValue(s,e)>0,o=n?this.btnValue(n,e)>0:!1;return!r&&o}getStick(e,t=0){let s=this.now.get(t);if(!s){for(const[I,y]of this.now.entries())if(y){s=y;break}}if(!s)return{x:0,y:0,magnitude:0};const n=e==="LEFT"?u.LS_X:u.RS_X,r=e==="LEFT"?u.LS_Y:u.RS_Y;let o=s.axes[n]??0,d=s.axes[r]??0;d=-d;const a=Math.hypot(o,d);if(a<this.deadzone)return{x:0,y:0,magnitude:0};const h=(a-this.deadzone)/(1-this.deadzone),p=h/(a||1);return{x:o*p,y:d*p,magnitude:h}}}const c={a:"A",A:"A",s:"B",S:"B",d:"X",D:"X",w:"Y",W:"Y",j:"A",J:"A",l:"B",L:"B",i:"Y",I:"Y",k:"X",K:"X",ArrowUp:"UP",ArrowDown:"DOWN",ArrowLeft:"LEFT",ArrowRight:"RIGHT",q:"LB",Q:"LB",e:"RB",E:"RB",z:"LT",Z:"LT",c:"RT",C:"RT",v:"LS",V:"LS",n:"RS",N:"RS",Tab:"VIEW",Enter:"MENU",Escape:"HOME"};class O{keysDown=new Set;prevKeysDown=new Set;leftStick={x:0,y:0};rightStick={x:0,y:0};constructor(){window.addEventListener("keydown",e=>{(c[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.add(e.key),this.updateSticks()}),window.addEventListener("keyup",e=>{(c[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.delete(e.key),this.updateSticks()})}updateSticks(){let e=0,t=0;this.keysDown.has("Control")&&((this.keysDown.has("a")||this.keysDown.has("A"))&&(e-=1),(this.keysDown.has("d")||this.keysDown.has("D"))&&(e+=1),(this.keysDown.has("w")||this.keysDown.has("W"))&&(t+=1),(this.keysDown.has("s")||this.keysDown.has("S"))&&(t-=1));let n=0,r=0;this.keysDown.has("Alt")&&((this.keysDown.has("j")||this.keysDown.has("J"))&&(n-=1),(this.keysDown.has("l")||this.keysDown.has("L"))&&(n+=1),(this.keysDown.has("i")||this.keysDown.has("I"))&&(r+=1),(this.keysDown.has("k")||this.keysDown.has("K"))&&(r-=1)),this.leftStick={x:e,y:t},this.rightStick={x:n,y:r}}update(){this.prevKeysDown=new Set(this.keysDown)}isDown(e){for(const[t,s]of Object.entries(c))if(s===e&&this.keysDown.has(t))return!0;return!1}justPressed(e){if(!this.isDown(e))return!1;for(const[s,n]of Object.entries(c))if(n===e&&this.prevKeysDown.has(s))return!1;return!0}justReleased(e){if(this.isDown(e))return!1;for(const[s,n]of Object.entries(c))if(n===e&&this.prevKeysDown.has(s))return!0;return!1}getStick(e){const t=e==="LEFT"?this.leftStick:this.rightStick,s=Math.hypot(t.x,t.y);return s>1?{x:t.x/s,y:t.y/s,magnitude:1}:{x:t.x,y:t.y,magnitude:s}}getKeyMappings(){return{...c}}}class v{gamepadManager;keyboardManager;constructor(){this.gamepadManager=new A,this.keyboardManager=new O}update(){this.gamepadManager.update(),this.keyboardManager.update()}isDown(e,t=0){return this.gamepadManager.isDown(e,t)||this.keyboardManager.isDown(e)}justPressed(e,t=0){return this.gamepadManager.justPressed(e,t)||this.keyboardManager.justPressed(e)}justReleased(e,t=0){return this.gamepadManager.justReleased(e,t)||this.keyboardManager.justReleased(e)}getStick(e,t=0){const s=this.gamepadManager.getStick(e,t);return s.magnitude>.1?s:this.keyboardManager.getStick(e)}get gamepad(){return this.gamepadManager}get keyboard(){return this.keyboardManager}firstGamepad(){return this.gamepadManager.first()}getActiveInputMethod(){const e=this.gamepadManager.first()!==null,t=this.keyboardManager.getStick("LEFT").magnitude>0||this.keyboardManager.getStick("RIGHT").magnitude>0||Object.values(this.keyboardManager.getKeyMappings()).some(s=>this.keyboardManager.isDown(s));return e&&t?"both":e?"gamepad":t?"keyboard":"none"}}const w=new v,f=document.getElementById("lock-screen"),k=document.getElementById("home"),m=document.getElementById("clock");document.getElementById("progress-ring");const D=document.getElementById("progress-circle"),g={LOCKED:"locked",UNLOCKED:"unlocked"};let E=g.LOCKED,l=!1,S=0;const M=600;function b(){const i=new Date;let e=i.getHours();const t=i.getMinutes();e===0?e=12:e>12&&(e=e-12);const s=`${e}:${t.toString().padStart(2,"0")}`;m&&(m.textContent=s)}b();setInterval(b,1e3);function R(){E=g.UNLOCKED,f&&(f.style.transform="translateY(-720px)",f.style.transition="transform 0.4s ease",setTimeout(()=>{f.style.zIndex="1",k&&(k.style.zIndex="10")},400)),console.log("Screen unlocked!")}function L(i){if(D){const t=100.53-i/100*100.53;D.style.strokeDashoffset=t}}function x(){if(w.update(),E===g.LOCKED)if(w.isDown("A")){l||(l=!0,S=Date.now());const i=Date.now()-S,e=Math.min(i/M*100,100);L(e),i>=M&&(R(),l=!1)}else l&&(l=!1,L(0));requestAnimationFrame(x)}requestAnimationFrame(x);console.log("Controller prototype initialized");console.log("Press and hold A (controller) or W (keyboard) to unlock");
