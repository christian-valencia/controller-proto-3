(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const $={LS_X:0,LS_Y:1,RS_X:2,RS_Y:3},fe={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,VIEW:8,MENU:9,LS:10,RS:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16};class ge{prev=new Map;now=new Map;deadzone=.18;triggerThreshold=.2;indexOfFirst=null;constructor(){console.log("ðŸŽ® GamepadManager initialized"),window.addEventListener("gamepadconnected",e=>{console.log("ðŸŽ® GAMEPAD CONNECTED:",e.gamepad.id),this.indexOfFirst===null&&(this.indexOfFirst=e.gamepad.index)}),window.addEventListener("gamepaddisconnected",e=>{console.log("ðŸŽ® GAMEPAD DISCONNECTED:",e.gamepad.id);const s=e.gamepad.index;this.indexOfFirst===s&&(this.indexOfFirst=null)})}first(){const e=navigator.getGamepads();for(const s of e)if(s)return s;return null}logControllers(){const e=navigator.getGamepads();console.log("ðŸŽ® Checking for controllers..."),console.log("ðŸŽ® navigator.getGamepads():",e);for(let s=0;s<e.length;s++){const n=e[s];n&&console.log(`ðŸŽ® Controller ${s}:`,n.id,"buttons:",n.buttons.length)}}update(){this.prev=new Map(this.now),this.now.clear();const e=navigator.getGamepads();for(const s of e)s&&(this.now.set(s.index,s),s.buttons[3]&&s.buttons[3].pressed&&console.log("ðŸŽ® GAMEPAD Y BUTTON PRESSED!",s.id))}btnValue(e,s){const n=e.buttons[fe[s]];return n?s==="LT"||s==="RT"?n.value>=this.triggerThreshold?n.value:0:n.pressed?1:0:0}isDown(e,s=0){let n=this.now.get(s);if(!n){for(const[a,r]of this.now.entries())if(r){n=r,e==="Y"&&console.log("ðŸŽ® GamepadManager.isDown - Found gamepad at index",a,"instead of",s);break}}if(!n)return e==="Y"&&console.log("ðŸŽ® GamepadManager.isDown - No gamepad found at any index"),!1;const o=this.btnValue(n,e)>0;return e==="Y"&&console.log('ðŸŽ® GamepadManager.isDown("Y") =',o,"btnValue =",this.btnValue(n,e)),o}justPressed(e,s=0){let n=this.now.get(s),o=this.prev.get(s);if(!n){for(const[c,f]of this.now.entries())if(f){n=f,o=this.prev.get(c);break}}if(!n)return!1;const a=this.btnValue(n,e)>0,r=o?this.btnValue(o,e)>0:!1;return a&&!r}justReleased(e,s=0){let n=this.now.get(s),o=this.prev.get(s);if(!n){for(const[c,f]of this.now.entries())if(f){n=f,o=this.prev.get(c);break}}if(!n)return!1;const a=this.btnValue(n,e)>0,r=o?this.btnValue(o,e)>0:!1;return!a&&r}getStick(e,s=0){let n=this.now.get(s);if(!n){for(const[S,T]of this.now.entries())if(T){n=T;break}}if(!n)return{x:0,y:0,magnitude:0};const o=e==="LEFT"?$.LS_X:$.RS_X,a=e==="LEFT"?$.LS_Y:$.RS_Y;let r=n.axes[o]??0,c=n.axes[a]??0;c=-c;const f=Math.hypot(r,c);if(f<this.deadzone)return{x:0,y:0,magnitude:0};const y=(f-this.deadzone)/(1-this.deadzone),m=y/(f||1);return{x:r*m,y:c*m,magnitude:y}}}const x={a:"A",A:"A",s:"B",S:"B",d:"X",D:"X",w:"Y",W:"Y",j:"A",J:"A",l:"B",L:"B",i:"Y",I:"Y",k:"X",K:"X",ArrowUp:"UP",ArrowDown:"DOWN",ArrowLeft:"LEFT",ArrowRight:"RIGHT",q:"LB",Q:"LB",e:"RB",E:"RB",z:"LT",Z:"LT",c:"RT",C:"RT",v:"LS",V:"LS",n:"RS",N:"RS",Tab:"VIEW",Enter:"MENU",Escape:"HOME"};class he{keysDown=new Set;prevKeysDown=new Set;leftStick={x:0,y:0};rightStick={x:0,y:0};constructor(){window.addEventListener("keydown",e=>{(x[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.add(e.key),this.updateSticks()}),window.addEventListener("keyup",e=>{(x[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.delete(e.key),this.updateSticks()})}updateSticks(){let e=0,s=0;this.keysDown.has("Control")&&((this.keysDown.has("a")||this.keysDown.has("A"))&&(e-=1),(this.keysDown.has("d")||this.keysDown.has("D"))&&(e+=1),(this.keysDown.has("w")||this.keysDown.has("W"))&&(s+=1),(this.keysDown.has("s")||this.keysDown.has("S"))&&(s-=1));let o=0,a=0;this.keysDown.has("Alt")&&((this.keysDown.has("j")||this.keysDown.has("J"))&&(o-=1),(this.keysDown.has("l")||this.keysDown.has("L"))&&(o+=1),(this.keysDown.has("i")||this.keysDown.has("I"))&&(a+=1),(this.keysDown.has("k")||this.keysDown.has("K"))&&(a-=1)),this.leftStick={x:e,y:s},this.rightStick={x:o,y:a}}update(){this.prevKeysDown=new Set(this.keysDown)}isDown(e){for(const[s,n]of Object.entries(x))if(n===e&&this.keysDown.has(s))return!0;return!1}justPressed(e){if(!this.isDown(e))return!1;for(const[n,o]of Object.entries(x))if(o===e&&this.prevKeysDown.has(n))return!1;return!0}justReleased(e){if(this.isDown(e))return!1;for(const[n,o]of Object.entries(x))if(o===e&&this.prevKeysDown.has(n))return!0;return!1}getStick(e){const s=e==="LEFT"?this.leftStick:this.rightStick,n=Math.hypot(s.x,s.y);return n>1?{x:s.x/n,y:s.y/n,magnitude:1}:{x:s.x,y:s.y,magnitude:n}}getKeyMappings(){return{...x}}}class pe{gamepadManager;keyboardManager;constructor(){this.gamepadManager=new ge,this.keyboardManager=new he}update(){this.gamepadManager.update(),this.keyboardManager.update()}isDown(e,s=0){return this.gamepadManager.isDown(e,s)||this.keyboardManager.isDown(e)}justPressed(e,s=0){return this.gamepadManager.justPressed(e,s)||this.keyboardManager.justPressed(e)}justReleased(e,s=0){return this.gamepadManager.justReleased(e,s)||this.keyboardManager.justReleased(e)}getStick(e,s=0){const n=this.gamepadManager.getStick(e,s);return n.magnitude>.1?n:this.keyboardManager.getStick(e)}get gamepad(){return this.gamepadManager}get keyboard(){return this.keyboardManager}firstGamepad(){return this.gamepadManager.first()}getActiveInputMethod(){const e=this.gamepadManager.first()!==null,s=this.keyboardManager.getStick("LEFT").magnitude>0||this.keyboardManager.getStick("RIGHT").magnitude>0||Object.values(this.keyboardManager.getKeyMappings()).some(n=>this.keyboardManager.isDown(n));return e&&s?"both":e?"gamepad":s?"keyboard":"none"}}document.getElementById("windows-shell");document.getElementById("lock-screen");const Z=document.getElementById("system-tray"),ee=document.getElementById("switcher"),U=document.getElementById("clock"),te=document.getElementById("clock2"),se=document.getElementById("auth");document.getElementById("progress-ring");const I=document.getElementById("progress-circle"),me=document.getElementById("green"),ye=document.getElementById("blue"),ve=document.getElementById("orange");let P=[me,ye,ve],b=["green","blue","orange"];const i=new pe;let ne=0;window.addEventListener("keydown",t=>{if((t.key.toLowerCase()==="s"||t.key.toLowerCase()==="l")&&k===p.SHELL&&v){const e=Date.now();e-ne>200&&(console.log(`Direct B button handler - closing ${v}`),G(v),ne=e)}});const p={LOCKED:"locked",SHELL:"shell",MENU:"menu",APP:"app"};let k=p.LOCKED,g=0,u=0;const D=300;let C=!1,oe=0;const we=300;let l="preview",w=0,Y={area:"preview",navIndex:0,appIndex:0},v=null;const A=["library","settings","notifications","gallery"];let L=0,h=0;const Le=3,W=[5,12,20];let O=!1,q=0;const be=700;let j=!1,V=0;const ie=700;window.addEventListener("keydown",t=>{t.key.toLowerCase()==="f"&&z()});function z(){document.fullscreenElement?document.exitFullscreen().catch(console.error):document.documentElement.requestFullscreen().catch(console.error)}function le(){i.update(),ke(),Ie(),requestAnimationFrame(le)}function ke(){switch(k){case p.LOCKED:Ee();break;case p.SHELL:Ue(),De();break;case p.MENU:Fe();break;case p.APP:Ge();break;default:console.warn("Unknown UI state:",k);break}i.justPressed("VIEW")&&z(),i.justPressed("MENU")&&k===p.LOCKED&&z()}function Ee(){if(k!==p.LOCKED)return;const t=i.isDown("Y");if(t&&!O)O=!0,q=Date.now(),I&&(I.style.transition="none",I.style.strokeDashoffset="100.53");else if(t&&O){const e=Date.now()-q,s=Math.min(e/be,1);if(I){const o=100.53*(1-s);I.style.strokeDashoffset=o.toString()}s>=1&&Se()}else!t&&O&&ae()}function Se(){console.log("Hold complete! Authentication action triggered."),C=!1,F(p.SHELL),X(),g=0,l="preview";const t=document.getElementById("focus"),e=document.getElementById("green-preview");e&&(e.classList.add("preview-scaled"),C=!0),t&&(t.classList.add("visible"),E()),se&&se.classList.add("slide-out"),ae(),d.confirmation(),console.log("Lock screen unlocked! Shell interactions now active.")}function ae(){k===p.LOCKED&&(O=!1,q=0,I&&(I.style.transition="stroke-dashoffset 0.2s ease",I.style.strokeDashoffset="100.53"))}function De(){if(k!==p.SHELL||!C||l!=="preview")return;const t=i.isDown("X");t&&!j?(j=!0,V=Date.now(),console.log("X button hold started - will scale down preview in",ie+"ms")):t&&j?Date.now()-V>=ie&&Be():!t&&j&&re()}function Be(){console.log("X button hold complete! Scaling down preview and reordering to leftmost position.");const e=b.map(s=>document.getElementById(`${s}-preview`))[g];if(e&&e.classList.contains("preview-scaled")){e.classList.remove("preview-scaled"),C=!1;const s=document.getElementById("running-apps");s&&s.classList.add("visible");const n=document.getElementById("shell-nav");if(n&&n.classList.add("visible"),g!==0){console.log(`Reordering: Moving ${b[g]} to leftmost position`);const o=P[g],a=b[g];P.splice(g,1),b.splice(g,1),P.unshift(o),b.unshift(a);const r=document.getElementById("running-apps");r&&(r.innerHTML="",P.forEach(c=>{c&&r.appendChild(c)})),g=0,console.log("New app order:",b)}de(),X(),E(),d.confirmation()}re()}function re(){j=!1,V=0}function Ie(){Pe(),ce()}function ce(){const t=k!==p.LOCKED;Z&&(Z.className=t?"unlocked":"locked"),ee&&(ee.className=t?"unlocked":"locked"),U&&(t?U.classList.add("slide-out"):U.classList.remove("slide-out"))}function Pe(){const t=new Date;let e=t.getHours();const s=t.getMinutes();e===0?e=12:e>12&&(e=e-12);const n=`${e}:${s.toString().padStart(2,"0")}`;U&&(U.textContent=n),te&&(te.textContent=n)}async function R(t=1,e=200){const s=i.firstGamepad();if(!s)return;const n=s.vibrationActuator;if(n)try{await n.playEffect("dual-rumble",{duration:e,strongMagnitude:t,weakMagnitude:t})}catch(o){console.warn("Rumble not supported:",o)}}const d={lightTap:()=>R(.2,50),confirmation:()=>R(.8,200),navigation:()=>R(.1,30),error:()=>R(.6,100),menuToggle:()=>R(.4,150),selectionChange:()=>R(.15,25)};function F(t){console.log(`UI State: ${k} â†’ ${t}`),k=t;const e=document.getElementById("blur-container");e&&(t!==p.LOCKED?e.classList.add("visible"):e.classList.remove("visible")),ce(),X()}function M(t){const e=g;t==="right"?g=(g+1)%P.length:t==="left"&&(g=(g-1+P.length)%P.length),console.log(`App Navigation: ${b[e]} â†’ ${b[g]}`),X(),d.selectionChange()}function N(t){const e=w;t==="right"?w=(w+1)%A.length:t==="left"&&(w=(w-1+A.length)%A.length),console.log(`Shell Nav Navigation: ${A[e]} â†’ ${A[w]}`),E(),d.selectionChange()}function X(){k===p.SHELL&&(P.forEach((t,e)=>{t&&(e===g?(t.classList.add("app-active"),t.classList.remove("app-rest")):(t.classList.add("app-rest"),t.classList.remove("app-active")))}),de())}function de(){const t=b.map(e=>document.getElementById(`${e}-preview`));switch(t.forEach(e=>{e&&e.classList.remove("preview-center","preview-left","preview-right","preview-far-left","preview-far-right","preview-scaled")}),C=!1,g){case 0:t[0]?.classList.add("preview-center"),t[1]?.classList.add("preview-right"),t[2]?.classList.add("preview-far-right");break;case 1:t[0]?.classList.add("preview-left"),t[1]?.classList.add("preview-center"),t[2]?.classList.add("preview-right");break;case 2:t[0]?.classList.add("preview-far-left"),t[1]?.classList.add("preview-left"),t[2]?.classList.add("preview-center");break}E()}function Te(){const e=b.map(s=>document.getElementById(`${s}-preview`))[g];if(e)if(C)console.log("Preview already scaled up. Use VIEW button hold to scale down.");else{e.classList.add("preview-scaled"),C=!0;const s=document.getElementById("running-apps");s&&s.classList.remove("visible");const n=document.getElementById("shell-nav");n&&n.classList.remove("visible"),E(),d.confirmation()}}function E(){const t=document.getElementById("focus");if(t)if(t.classList.remove("focus-preview","focus-nav","focus-shell-surface","focus-shell-library","focus-shell-settings"),l==="preview"){_();const s=b.map(o=>document.getElementById(`${o}-preview`))[g];if(!s)return;s.classList.contains("preview-scaled")?(t.style.width="100vw",t.style.height="100vh"):(t.style.width="50vw",t.style.height="calc(50vh + 64px)"),t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.classList.add("focus-preview")}else if(l==="shell-nav"){t.classList.add("focus-nav");const e=document.getElementById(A[w]);if(!e)return;const s=e.getBoundingClientRect(),n=document.getElementById("windows-shell").getBoundingClientRect();t.style.width="64px",t.style.height="64px",t.style.top=`${s.top-n.top+s.height/2}px`,t.style.left=`${s.left-n.left+s.width/2}px`,t.style.transform="translate(-50%, -50%)",_(A[w])}else l==="shell-surface"&&(_(),ue())}function _(t=null){const e={library:document.getElementById("label-library"),settings:document.getElementById("label-settings"),notifications:document.getElementById("label-notifications"),gallery:document.getElementById("label-gallery")},s=document.getElementById("shell-nav");if(!t||!s){Object.values(e).forEach(y=>{y&&y.classList.remove("active","faded")});return}const n=document.getElementById(t);if(!n)return;const o=n.getBoundingClientRect(),a=s.getBoundingClientRect(),r=o.top-a.top,c=o.left-a.left,f=o.width;Object.entries(e).forEach(([y,m])=>{if(m)if(y===t){m.classList.add("active"),m.classList.remove("faded");const S=r-16-20,T=c+f/2;m.style.top=`${S}px`,m.style.left=`${T}px`,m.style.transform="translateX(-50%)"}else m.classList.remove("active"),m.classList.add("faded")})}function ue(){const t=document.getElementById("focus");t&&(t.classList.remove("focus-preview","focus-nav"),t.classList.add("focus-shell-surface"),t.style.width="200px",t.style.height="32px",t.style.top="92px",t.style.left="48px",t.style.transform="none",t.style.maxWidth="none",t.style.maxHeight="none",t.style.minWidth="none",t.style.minHeight="none")}function Ae(){l=Y.area,g=Y.appIndex,w=Y.navIndex,E()}function H(){const t=document.getElementById("focus"),e=document.querySelectorAll(".launcher-row-container"),s=document.querySelector(".library-content");if(!t||e.length===0)return;t.style.opacity="0",document.querySelectorAll(".launcher-app").forEach(o=>o.classList.remove("focused"));const n=e[h];if(n){const r=n.querySelector(".launchers").querySelectorAll(".launcher-app")[L];r&&r.classList.add("focused");const c=W[h];if(c>5){let y=0;if(L>=3){y=-(L-2)*194;const S=-(c-5)*194;y=Math.max(y,S)}n.style.transition="transform 0.3s ease",n.style.transform=`translateX(${y}px) translateY(${h>=2?-264*(h-1):0}px)`}else n.style.transition="transform 0.3s ease",n.style.transform=`translateX(0) translateY(${h>=2?-264*(h-1):0}px)`}if(s){let o=0;h>=2&&(o=-264*(h-1)),e.forEach((r,c)=>{c!==h&&(r.style.transition="transform 0.3s ease",r.style.transform=`translateY(${o}px)`)});const a=document.querySelector(".library-main-title");a&&(a.style.transform=`translateY(${o}px)`)}}function B(t){const e=W[h];t==="left"&&L>0?(L--,H()):t==="right"&&L<e-1?(L++,H()):t==="up"&&h>0?(h--,L=Math.min(L,W[h]-1),H()):t==="down"&&h<Le-1&&(h++,L=Math.min(L,W[h]-1),H())}function K(t){Y={area:l,navIndex:w,appIndex:g};const e=document.getElementById(`shell-${t}`),s=document.getElementById("focus"),n=document.getElementById("running-apps");if(!e)return;if(e.classList.add("visible"),console.log(`Shell ${t.charAt(0).toUpperCase()+t.slice(1)} sliding in from bottom`),n&&n.classList.remove("visible"),document.querySelectorAll(".preview-container").forEach(a=>{a.classList.add("hide-right")}),l="shell-surface",v=t,t==="library"){l="library-launchers",L=0,h=0,H();const a=document.querySelector(".library-background-image"),r=document.querySelector(".library-blur");a&&a.classList.add("visible"),r&&r.classList.add("visible")}s&&(t==="library"||t==="settings")&&s.classList.add(`focus-shell-${t}`),ue()}function G(t){const e=document.getElementById(`shell-${t}`),s=document.getElementById("focus"),n=document.getElementById("running-apps");if(!e)return;if(e.classList.remove("visible"),console.log(`Shell ${t.charAt(0).toUpperCase()+t.slice(1)} sliding out to bottom`),n&&n.classList.add("visible"),document.querySelectorAll(".preview-container").forEach(a=>{a.classList.remove("hide-right")}),s&&(t==="library"||t==="settings")&&s.classList.remove(`focus-shell-${t}`),v=null,l==="library-launchers"){L=0,h=0,document.querySelectorAll(".launcher-app").forEach(c=>{c.classList.remove("focused")}),document.querySelectorAll(".launchers").forEach(c=>{c.style.transform="translateX(0) translateY(0)"}),s&&(s.style.opacity="1");const a=document.querySelector(".library-background-image"),r=document.querySelector(".library-blur");a&&a.classList.remove("visible"),r&&r.classList.remove("visible")}Ae()}function Ce(){K("library")}function xe(){G("library")}function Re(){K("settings")}function Me(){G("settings")}function Ne(){K("notifications")}function Oe(){G("notifications")}function je(){K("gallery")}function He(){G("gallery")}function Ue(){console.log("Shell inputs active - ready for desktop interactions!");const t=Date.now(),e={LEFT:i.isDown("LEFT"),RIGHT:i.isDown("RIGHT"),LB:i.isDown("LB"),RB:i.isDown("RB"),leftJust:i.justPressed("LEFT"),rightJust:i.justPressed("RIGHT"),lbJust:i.justPressed("LB"),rbJust:i.justPressed("RB")};Object.values(e).some(S=>S)&&console.log("Input detected:",e);const n=i.justPressed("LEFT"),o=i.justPressed("RIGHT"),a=i.justPressed("LB"),r=i.justPressed("RB");(n||o||a||r)&&console.log("Navigation input detected:",{leftPressed:n,rightPressed:o,lbPressed:a,rbPressed:r}),(i.justPressed("LEFT")||i.isDown("LEFT")&&t-u>D)&&(console.log("LEFT input detected"),l==="library-launchers"?(console.log("Navigating launchers left"),B("left"),u=t):l!=="shell-surface"?(l==="preview"?(console.log("Navigating apps left"),M("left")):l==="shell-nav"&&(console.log("Navigating shell-nav left"),N("left")),u=t):console.log("LEFT navigation blocked - currently in shell surface:",v)),(i.justPressed("RIGHT")||i.isDown("RIGHT")&&t-u>D)&&(console.log("RIGHT input detected"),l==="library-launchers"?(console.log("Navigating launchers right"),B("right"),u=t):l!=="shell-surface"?(l==="preview"?(console.log("Navigating apps right"),M("right")):l==="shell-nav"&&(console.log("Navigating shell-nav right"),N("right")),u=t):console.log("RIGHT navigation blocked - currently in shell surface:",v)),(i.justPressed("LB")||i.isDown("LB")&&t-u>D)&&(console.log("LB input detected"),l!=="shell-surface"?(l==="preview"?(console.log("Navigating apps left"),M("left")):l==="shell-nav"&&(console.log("Navigating shell-nav left"),N("left")),u=t):console.log("LB navigation blocked - currently in shell surface:",v)),(i.justPressed("RB")||i.isDown("RB")&&t-u>D)&&(console.log("RB input detected"),l!=="shell-surface"?(l==="preview"?(console.log("Navigating apps right"),M("right")):l==="shell-nav"&&(console.log("Navigating shell-nav right"),N("right")),u=t):console.log("RB navigation blocked - currently in shell surface:",v));const c=i.getStick("LEFT"),f=Date.now();c.magnitude>.6&&f-u>D&&(l==="library-launchers"?c.x>.6?(console.log("Left stick RIGHT - navigating launchers"),B("right"),u=f):c.x<-.6&&(console.log("Left stick LEFT - navigating launchers"),B("left"),u=f):l!=="shell-surface"?c.x>.6?(l==="preview"?M("right"):l==="shell-nav"&&N("right"),u=f):c.x<-.6&&(l==="preview"?M("left"):l==="shell-nav"&&N("left"),u=f):console.log("Stick navigation blocked - currently in shell surface:",v)),c.magnitude>.6&&f-u>D&&(l==="library-launchers"?c.y>.6?(console.log("Left stick UP - navigating launchers"),B("up"),u=f):c.y<-.6&&(console.log("Left stick DOWN - navigating launchers"),B("down"),u=f):l!=="shell-surface"?c.y>.6?(console.log("Analog stick UP detected - moving focus back to preview"),l==="shell-nav"&&(l="preview",E(),u=f)):c.y<-.6&&(console.log("Analog stick DOWN detected - moving focus to shell-nav"),l==="preview"&&(l="shell-nav",E(),u=f)):console.log("Analog stick vertical navigation blocked - currently in shell surface:",v)),(i.justPressed("DOWN")||i.isDown("DOWN")&&t-u>D)&&(l==="library-launchers"?(console.log("Navigating launchers down"),B("down"),u=t):l!=="shell-surface"?(console.log("DOWN input detected - moving focus to shell-nav"),l==="preview"&&(l="shell-nav",E(),u=t)):console.log("DOWN input blocked - currently in shell surface:",v)),(i.justPressed("UP")||i.isDown("UP")&&t-u>D)&&(l==="library-launchers"?(console.log("Navigating launchers up"),B("up"),u=t):l!=="shell-surface"?(console.log("UP input detected - moving focus back to preview"),l==="shell-nav"&&(l="preview",E(),u=t)):console.log("UP input blocked - currently in shell surface:",v)),i.justPressed("UP")&&(console.log("Navigate UP - future functionality"),d.navigation()),i.justPressed("DOWN")&&(console.log("Navigate DOWN - future functionality"),d.navigation());const y=Date.now();if(i.isDown("A")&&y-oe>we&&(oe=y,l==="preview"?Te():l==="shell-nav"?w===0?(console.log("Opening Library..."),Ce(),d.confirmation()):w===1?(console.log("Opening Settings..."),Re(),d.confirmation()):w===2?(console.log("Opening Notifications..."),Ne(),d.confirmation()):w===3&&(console.log("Opening Gallery..."),je(),d.confirmation()):l==="shell-surface"&&(console.log("A button pressed in shell surface:",v),d.lightTap())),i.justPressed("B")){const S=document.getElementById("shell-library"),T=document.getElementById("shell-settings"),J=document.getElementById("shell-notifications"),Q=document.getElementById("shell-gallery");console.log("B button pressed via InputManager"),S&&S.classList.contains("visible")?(console.log("Shell: B button - Closing Library"),xe(),d.lightTap()):T&&T.classList.contains("visible")?(console.log("Shell: B button - Closing Settings"),Me(),d.lightTap()):J&&J.classList.contains("visible")?(console.log("Shell: B button - Closing Notifications"),Oe(),d.lightTap()):Q&&Q.classList.contains("visible")?(console.log("Shell: B button - Closing Gallery"),He(),d.lightTap()):(console.log("Shell: B button - Back/Cancel"),d.lightTap())}i.justPressed("Y")&&(console.log("Shell: Y button - Alternative action"),d.lightTap()),i.justPressed("LT")&&(console.log("Shell: LT - Previous app"),d.menuToggle()),i.justPressed("RT")&&(console.log("Shell: RT - Next app"),d.menuToggle());const m=i.getStick("RIGHT");m.magnitude>.3&&console.log(`Shell: Right stick scrolling - x:${m.x.toFixed(2)}, y:${m.y.toFixed(2)}`),i.justPressed("LS")&&(console.log("Shell: Left stick click - Quick action"),d.lightTap()),i.justPressed("RS")&&(console.log("Shell: Right stick click - Context menu"),d.lightTap()),i.justPressed("MENU")&&(console.log("Shell: Opening main menu"),F(p.MENU),d.menuToggle())}function Fe(){console.log("Menu inputs active - navigating menu system!"),i.justPressed("UP")&&(console.log("Menu: Navigate up"),d.selectionChange()),i.justPressed("DOWN")&&(console.log("Menu: Navigate down"),d.selectionChange()),i.justPressed("A")&&(console.log("Menu: Select item"),d.confirmation()),i.justPressed("B")&&(console.log("Menu: Back to shell"),F(p.SHELL),d.menuToggle()),i.justPressed("MENU")&&(console.log("Menu: Closing menu"),F(p.SHELL),d.menuToggle())}function Ge(){console.log("App inputs active - app-specific controls!"),i.justPressed("B")&&(console.log("App: Back to shell"),F(p.SHELL),d.lightTap())}requestAnimationFrame(le);
