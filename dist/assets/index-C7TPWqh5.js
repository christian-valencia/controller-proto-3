(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();const Y={LS_X:0,LS_Y:1,RS_X:2,RS_Y:3},he={A:0,B:1,X:2,Y:3,LB:4,RB:5,LT:6,RT:7,VIEW:8,MENU:9,LS:10,RS:11,UP:12,DOWN:13,LEFT:14,RIGHT:15,HOME:16};class pe{prev=new Map;now=new Map;deadzone=.18;triggerThreshold=.2;indexOfFirst=null;constructor(){console.log("ðŸŽ® GamepadManager initialized"),window.addEventListener("gamepadconnected",e=>{console.log("ðŸŽ® GAMEPAD CONNECTED:",e.gamepad.id),this.indexOfFirst===null&&(this.indexOfFirst=e.gamepad.index)}),window.addEventListener("gamepaddisconnected",e=>{console.log("ðŸŽ® GAMEPAD DISCONNECTED:",e.gamepad.id);const s=e.gamepad.index;this.indexOfFirst===s&&(this.indexOfFirst=null)})}first(){const e=navigator.getGamepads();for(const s of e)if(s)return s;return null}logControllers(){const e=navigator.getGamepads();console.log("ðŸŽ® Checking for controllers..."),console.log("ðŸŽ® navigator.getGamepads():",e);for(let s=0;s<e.length;s++){const n=e[s];n&&console.log(`ðŸŽ® Controller ${s}:`,n.id,"buttons:",n.buttons.length)}}update(){this.prev=new Map(this.now),this.now.clear();const e=navigator.getGamepads();for(const s of e)s&&(this.now.set(s.index,s),s.buttons[3]&&s.buttons[3].pressed&&console.log("ðŸŽ® GAMEPAD Y BUTTON PRESSED!",s.id))}btnValue(e,s){const n=e.buttons[he[s]];return n?s==="LT"||s==="RT"?n.value>=this.triggerThreshold?n.value:0:n.pressed?1:0:0}isDown(e,s=0){let n=this.now.get(s);if(!n){for(const[a,r]of this.now.entries())if(r){n=r,e==="Y"&&console.log("ðŸŽ® GamepadManager.isDown - Found gamepad at index",a,"instead of",s);break}}if(!n)return e==="Y"&&console.log("ðŸŽ® GamepadManager.isDown - No gamepad found at any index"),!1;const o=this.btnValue(n,e)>0;return e==="Y"&&console.log('ðŸŽ® GamepadManager.isDown("Y") =',o,"btnValue =",this.btnValue(n,e)),o}justPressed(e,s=0){let n=this.now.get(s),o=this.prev.get(s);if(!n){for(const[c,f]of this.now.entries())if(f){n=f,o=this.prev.get(c);break}}if(!n)return!1;const a=this.btnValue(n,e)>0,r=o?this.btnValue(o,e)>0:!1;return a&&!r}justReleased(e,s=0){let n=this.now.get(s),o=this.prev.get(s);if(!n){for(const[c,f]of this.now.entries())if(f){n=f,o=this.prev.get(c);break}}if(!n)return!1;const a=this.btnValue(n,e)>0,r=o?this.btnValue(o,e)>0:!1;return!a&&r}getStick(e,s=0){let n=this.now.get(s);if(!n){for(const[S,A]of this.now.entries())if(A){n=A;break}}if(!n)return{x:0,y:0,magnitude:0};const o=e==="LEFT"?Y.LS_X:Y.RS_X,a=e==="LEFT"?Y.LS_Y:Y.RS_Y;let r=n.axes[o]??0,c=n.axes[a]??0;c=-c;const f=Math.hypot(r,c);if(f<this.deadzone)return{x:0,y:0,magnitude:0};const v=(f-this.deadzone)/(1-this.deadzone),m=v/(f||1);return{x:r*m,y:c*m,magnitude:v}}}const M={a:"A",A:"A",s:"B",S:"B",d:"X",D:"X",w:"Y",W:"Y",j:"A",J:"A",l:"B",L:"B",i:"Y",I:"Y",k:"X",K:"X",ArrowUp:"UP",ArrowDown:"DOWN",ArrowLeft:"LEFT",ArrowRight:"RIGHT",q:"LB",Q:"LB",e:"RB",E:"RB",z:"LT",Z:"LT",c:"RT",C:"RT",v:"LS",V:"LS",n:"RS",N:"RS",Tab:"VIEW",Enter:"MENU",Escape:"HOME"};class me{keysDown=new Set;prevKeysDown=new Set;leftStick={x:0,y:0};rightStick={x:0,y:0};constructor(){window.addEventListener("keydown",e=>{(M[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.add(e.key),this.updateSticks()}),window.addEventListener("keyup",e=>{(M[e.key]||e.key==="Tab")&&e.preventDefault(),this.keysDown.delete(e.key),this.updateSticks()})}updateSticks(){let e=0,s=0;this.keysDown.has("Control")&&((this.keysDown.has("a")||this.keysDown.has("A"))&&(e-=1),(this.keysDown.has("d")||this.keysDown.has("D"))&&(e+=1),(this.keysDown.has("w")||this.keysDown.has("W"))&&(s+=1),(this.keysDown.has("s")||this.keysDown.has("S"))&&(s-=1));let o=0,a=0;this.keysDown.has("Alt")&&((this.keysDown.has("j")||this.keysDown.has("J"))&&(o-=1),(this.keysDown.has("l")||this.keysDown.has("L"))&&(o+=1),(this.keysDown.has("i")||this.keysDown.has("I"))&&(a+=1),(this.keysDown.has("k")||this.keysDown.has("K"))&&(a-=1)),this.leftStick={x:e,y:s},this.rightStick={x:o,y:a}}update(){this.prevKeysDown=new Set(this.keysDown)}isDown(e){for(const[s,n]of Object.entries(M))if(n===e&&this.keysDown.has(s))return!0;return!1}justPressed(e){if(!this.isDown(e))return!1;for(const[n,o]of Object.entries(M))if(o===e&&this.prevKeysDown.has(n))return!1;return!0}justReleased(e){if(this.isDown(e))return!1;for(const[n,o]of Object.entries(M))if(o===e&&this.prevKeysDown.has(n))return!0;return!1}getStick(e){const s=e==="LEFT"?this.leftStick:this.rightStick,n=Math.hypot(s.x,s.y);return n>1?{x:s.x/n,y:s.y/n,magnitude:1}:{x:s.x,y:s.y,magnitude:n}}getKeyMappings(){return{...M}}}class ve{gamepadManager;keyboardManager;constructor(){this.gamepadManager=new pe,this.keyboardManager=new me}update(){this.gamepadManager.update(),this.keyboardManager.update()}isDown(e,s=0){return this.gamepadManager.isDown(e,s)||this.keyboardManager.isDown(e)}justPressed(e,s=0){return this.gamepadManager.justPressed(e,s)||this.keyboardManager.justPressed(e)}justReleased(e,s=0){return this.gamepadManager.justReleased(e,s)||this.keyboardManager.justReleased(e)}getStick(e,s=0){const n=this.gamepadManager.getStick(e,s);return n.magnitude>.1?n:this.keyboardManager.getStick(e)}get gamepad(){return this.gamepadManager}get keyboard(){return this.keyboardManager}firstGamepad(){return this.gamepadManager.first()}getActiveInputMethod(){const e=this.gamepadManager.first()!==null,s=this.keyboardManager.getStick("LEFT").magnitude>0||this.keyboardManager.getStick("RIGHT").magnitude>0||Object.values(this.keyboardManager.getKeyMappings()).some(n=>this.keyboardManager.isDown(n));return e&&s?"both":e?"gamepad":s?"keyboard":"none"}}document.getElementById("windows-shell");document.getElementById("lock-screen");const se=document.getElementById("system-tray"),ne=document.getElementById("switcher"),F=document.getElementById("clock"),oe=document.getElementById("clock2"),ie=document.getElementById("auth");document.getElementById("progress-ring");const B=document.getElementById("progress-circle"),ye=document.getElementById("green"),we=document.getElementById("blue"),Le=document.getElementById("orange");let T=[ye,we,Le],E=["green","blue","orange"];const l=new ve;let le=0;window.addEventListener("keydown",t=>{if((t.key.toLowerCase()==="s"||t.key.toLowerCase()==="l")&&k===p.SHELL&&y){const e=Date.now();e-le>200&&(console.log(`Direct B button handler - closing ${y}`),$(y),le=e)}});const p={LOCKED:"locked",SHELL:"shell",MENU:"menu",APP:"app"};let k=p.LOCKED,g=0,d=0;const I=300;let C=!1,ae=0;const Ee=300;let i="preview",w=0,X={area:"preview",navIndex:0,appIndex:0},y=null;const N=["library","settings","notifications","gallery"];let L=0,h=0;const ke=3,_=[5,12,20];let P=0;const be=11;let j=!1,z=0;const Se=700;let H=!1,J=0;const re=700;window.addEventListener("keydown",t=>{t.key.toLowerCase()==="f"&&Q()});function Q(){document.fullscreenElement?document.exitFullscreen().catch(console.error):document.documentElement.requestFullscreen().catch(console.error)}function ce(){l.update(),Ie(),Ae(),requestAnimationFrame(ce)}function Ie(){switch(k){case p.LOCKED:De();break;case p.SHELL:$e(),Te();break;case p.MENU:Ye();break;case p.APP:We();break;default:console.warn("Unknown UI state:",k);break}l.justPressed("VIEW")&&Q(),l.justPressed("MENU")&&k===p.LOCKED&&Q()}function De(){if(k!==p.LOCKED)return;const t=l.isDown("Y");if(t&&!j)j=!0,z=Date.now(),B&&(B.style.transition="none",B.style.strokeDashoffset="100.53");else if(t&&j){const e=Date.now()-z,s=Math.min(e/Se,1);if(B){const o=100.53*(1-s);B.style.strokeDashoffset=o.toString()}s>=1&&Be()}else!t&&j&&de()}function Be(){console.log("Hold complete! Authentication action triggered."),C=!1,G(p.SHELL),K(),g=0,i="preview";const t=document.getElementById("focus"),e=document.getElementById("green-preview");e&&(e.classList.add("preview-scaled"),C=!0),t&&(t.classList.add("visible"),b()),ie&&ie.classList.add("slide-out"),de(),u.confirmation(),console.log("Lock screen unlocked! Shell interactions now active.")}function de(){k===p.LOCKED&&(j=!1,z=0,B&&(B.style.transition="stroke-dashoffset 0.2s ease",B.style.strokeDashoffset="100.53"))}function Te(){if(k!==p.SHELL||!C||i!=="preview")return;const t=l.isDown("X");t&&!H?(H=!0,J=Date.now(),console.log("X button hold started - will scale down preview in",re+"ms")):t&&H?Date.now()-J>=re&&Pe():!t&&H&&ue()}function Pe(){console.log("X button hold complete! Scaling down preview and reordering to leftmost position.");const e=E.map(s=>document.getElementById(`${s}-preview`))[g];if(e&&e.classList.contains("preview-scaled")){e.classList.remove("preview-scaled"),C=!1;const s=document.getElementById("running-apps");s&&s.classList.add("visible");const n=document.getElementById("shell-nav");if(n&&n.classList.add("visible"),g!==0){console.log(`Reordering: Moving ${E[g]} to leftmost position`);const o=T[g],a=E[g];T.splice(g,1),E.splice(g,1),T.unshift(o),E.unshift(a);const r=document.getElementById("running-apps");r&&(r.innerHTML="",T.forEach(c=>{c&&r.appendChild(c)})),g=0,console.log("New app order:",E)}ge(),K(),b(),u.confirmation()}ue()}function ue(){H=!1,J=0}function Ae(){Ne(),fe()}function fe(){const t=k!==p.LOCKED;se&&(se.className=t?"unlocked":"locked"),ne&&(ne.className=t?"unlocked":"locked"),F&&(t?F.classList.add("slide-out"):F.classList.remove("slide-out"))}function Ne(){const t=new Date;let e=t.getHours();const s=t.getMinutes();e===0?e=12:e>12&&(e=e-12);const n=`${e}:${s.toString().padStart(2,"0")}`;F&&(F.textContent=n),oe&&(oe.textContent=n)}async function R(t=1,e=200){const s=l.firstGamepad();if(!s)return;const n=s.vibrationActuator;if(n)try{await n.playEffect("dual-rumble",{duration:e,strongMagnitude:t,weakMagnitude:t})}catch(o){console.warn("Rumble not supported:",o)}}const u={lightTap:()=>R(.2,50),confirmation:()=>R(.8,200),navigation:()=>R(.1,30),error:()=>R(.6,100),menuToggle:()=>R(.4,150),selectionChange:()=>R(.15,25)};function G(t){console.log(`UI State: ${k} â†’ ${t}`),k=t;const e=document.getElementById("blur-container");e&&(t!==p.LOCKED?e.classList.add("visible"):e.classList.remove("visible")),fe(),K()}function x(t){const e=g;t==="right"?g=(g+1)%T.length:t==="left"&&(g=(g-1+T.length)%T.length),console.log(`App Navigation: ${E[e]} â†’ ${E[g]}`),K(),u.selectionChange()}function O(t){const e=w;t==="right"?w=(w+1)%N.length:t==="left"&&(w=(w-1+N.length)%N.length),console.log(`Shell Nav Navigation: ${N[e]} â†’ ${N[w]}`),b(),u.selectionChange()}function K(){k===p.SHELL&&(T.forEach((t,e)=>{t&&(e===g?(t.classList.add("app-active"),t.classList.remove("app-rest")):(t.classList.add("app-rest"),t.classList.remove("app-active")))}),ge())}function ge(){const t=E.map(e=>document.getElementById(`${e}-preview`));switch(t.forEach(e=>{e&&e.classList.remove("preview-center","preview-left","preview-right","preview-far-left","preview-far-right","preview-scaled")}),C=!1,g){case 0:t[0]?.classList.add("preview-center"),t[1]?.classList.add("preview-right"),t[2]?.classList.add("preview-far-right");break;case 1:t[0]?.classList.add("preview-left"),t[1]?.classList.add("preview-center"),t[2]?.classList.add("preview-right");break;case 2:t[0]?.classList.add("preview-far-left"),t[1]?.classList.add("preview-left"),t[2]?.classList.add("preview-center");break}b()}function Ce(){const e=E.map(s=>document.getElementById(`${s}-preview`))[g];if(e)if(C)console.log("Preview already scaled up. Use VIEW button hold to scale down.");else{e.classList.add("preview-scaled"),C=!0;const s=document.getElementById("running-apps");s&&s.classList.remove("visible");const n=document.getElementById("shell-nav");n&&n.classList.remove("visible"),b(),u.confirmation()}}function b(){const t=document.getElementById("focus");if(t)if(t.classList.remove("focus-preview","focus-nav","focus-shell-surface","focus-shell-library","focus-shell-settings"),i==="preview"){V();const s=E.map(o=>document.getElementById(`${o}-preview`))[g];if(!s)return;s.classList.contains("preview-scaled")?(t.style.width="100vw",t.style.height="100vh"):(t.style.width="50vw",t.style.height="calc(50vh + 64px)"),t.style.top="50%",t.style.left="50%",t.style.transform="translate(-50%, -50%)",t.classList.add("focus-preview")}else if(i==="shell-nav"){t.classList.add("focus-nav");const e=document.getElementById(N[w]);if(!e)return;const s=e.getBoundingClientRect(),n=document.getElementById("windows-shell").getBoundingClientRect();t.style.width="64px",t.style.height="64px",t.style.top=`${s.top-n.top+s.height/2}px`,t.style.left=`${s.left-n.left+s.width/2}px`,t.style.transform="translate(-50%, -50%)",V(N[w])}else i==="shell-surface"&&V()}function V(t=null){const e={library:document.getElementById("label-library"),settings:document.getElementById("label-settings"),notifications:document.getElementById("label-notifications"),gallery:document.getElementById("label-gallery")},s=document.getElementById("shell-nav");if(!t||!s){Object.values(e).forEach(v=>{v&&v.classList.remove("active","faded")});return}const n=document.getElementById(t);if(!n)return;const o=n.getBoundingClientRect(),a=s.getBoundingClientRect(),r=o.top-a.top,c=o.left-a.left,f=o.width;Object.entries(e).forEach(([v,m])=>{if(m)if(v===t){m.classList.add("active"),m.classList.remove("faded");const S=r-16-20,A=c+f/2;m.style.top=`${S}px`,m.style.left=`${A}px`,m.style.transform="translateX(-50%)"}else m.classList.remove("active"),m.classList.add("faded")})}function Me(){i=X.area,g=X.appIndex,w=X.navIndex;const t=document.getElementById("focus"),e=document.getElementById("shell-nav");t&&(t.style.opacity="1"),e&&(e.style.opacity="1"),b()}function U(){const t=document.getElementById("focus"),e=document.querySelectorAll(".launcher-row-container"),s=document.querySelector(".library-content");if(!t||e.length===0)return;t.style.opacity="0",document.querySelectorAll(".launcher-app").forEach(o=>o.classList.remove("focused"));const n=e[h];if(n){const r=n.querySelector(".launchers").querySelectorAll(".launcher-app")[L];r&&r.classList.add("focused");const c=_[h];if(c>5){let v=0;if(L>=3){v=-(L-2)*194;const S=-(c-5)*194;v=Math.max(v,S)}n.style.transition="transform 0.3s ease",n.style.transform=`translateX(${v}px) translateY(${h>=2?-264*(h-1):0}px)`}else n.style.transition="transform 0.3s ease",n.style.transform=`translateX(0) translateY(${h>=2?-264*(h-1):0}px)`}if(s){let o=0;h>=2&&(o=-264*(h-1)),e.forEach((r,c)=>{c!==h&&(r.style.transition="transform 0.3s ease",r.style.transform=`translateY(${o}px)`)});const a=document.querySelector(".library-main-title");a&&(a.style.transform=`translateY(${o}px)`)}}function D(t){const e=_[h];t==="left"&&L>0?(L--,U()):t==="right"&&L<e-1?(L++,U()):t==="up"&&h>0?(h--,L=Math.min(L,_[h]-1),U()):t==="down"&&h<ke-1&&(h++,L=Math.min(L,_[h]-1),U())}function Z(){const t=document.querySelectorAll(".nav-page-item");!t||t.length===0||(t.forEach(e=>e.classList.remove("focused")),t[P]&&t[P].classList.add("focused"))}function W(t){t==="up"&&P>0?(P--,Z()):t==="down"&&P<be-1&&(P++,Z())}function q(t){X={area:i,navIndex:w,appIndex:g};const e=document.getElementById(`shell-${t}`),s=document.getElementById("focus"),n=document.getElementById("running-apps");if(!e)return;e.classList.add("visible"),console.log(`Shell ${t.charAt(0).toUpperCase()+t.slice(1)} sliding in from bottom`),n&&n.classList.remove("visible"),document.querySelectorAll(".preview-container").forEach(r=>{r.classList.add("hide-right")}),i="shell-surface",y=t;const a=document.getElementById("shell-nav");if(s&&(s.style.opacity="0"),a&&(a.style.opacity="0"),t==="library"&&(i="library-launchers",L=0,h=0,U()),t==="settings"){i="settings-nav",P=0,Z();const r=document.querySelectorAll(".nav-page-item");r[0]&&r[0].classList.add("selected")}}function $(t){const e=document.getElementById(`shell-${t}`);document.getElementById("focus");const s=document.getElementById("running-apps");if(!e)return;e.classList.remove("visible"),console.log(`Shell ${t.charAt(0).toUpperCase()+t.slice(1)} sliding out to bottom`),s&&s.classList.add("visible"),document.querySelectorAll(".preview-container").forEach(o=>{o.classList.remove("hide-right")}),y=null,i==="library-launchers"&&(L=0,h=0,document.querySelectorAll(".launcher-app").forEach(o=>{o.classList.remove("focused")}),document.querySelectorAll(".launchers").forEach(o=>{o.style.transform="translateX(0) translateY(0)"})),i==="settings-nav"&&(P=0,document.querySelectorAll(".nav-page-item").forEach(o=>{o.classList.remove("focused"),o.classList.remove("selected")})),Me()}function Re(){q("library")}function xe(){$("library")}function Oe(){q("settings")}function je(){$("settings")}function He(){q("notifications")}function Ue(){$("notifications")}function Fe(){q("gallery")}function Ge(){$("gallery")}function $e(){console.log("Shell inputs active - ready for desktop interactions!");const t=Date.now(),e={LEFT:l.isDown("LEFT"),RIGHT:l.isDown("RIGHT"),LB:l.isDown("LB"),RB:l.isDown("RB"),leftJust:l.justPressed("LEFT"),rightJust:l.justPressed("RIGHT"),lbJust:l.justPressed("LB"),rbJust:l.justPressed("RB")};Object.values(e).some(S=>S)&&console.log("Input detected:",e);const n=l.justPressed("LEFT"),o=l.justPressed("RIGHT"),a=l.justPressed("LB"),r=l.justPressed("RB");(n||o||a||r)&&console.log("Navigation input detected:",{leftPressed:n,rightPressed:o,lbPressed:a,rbPressed:r}),(l.justPressed("LEFT")||l.isDown("LEFT")&&t-d>I)&&(console.log("LEFT input detected"),i==="library-launchers"?(console.log("Navigating launchers left"),D("left"),d=t):i!=="shell-surface"?(i==="preview"?(console.log("Navigating apps left"),x("left")):i==="shell-nav"&&(console.log("Navigating shell-nav left"),O("left")),d=t):console.log("LEFT navigation blocked - currently in shell surface:",y)),(l.justPressed("RIGHT")||l.isDown("RIGHT")&&t-d>I)&&(console.log("RIGHT input detected"),i==="library-launchers"?(console.log("Navigating launchers right"),D("right"),d=t):i!=="shell-surface"?(i==="preview"?(console.log("Navigating apps right"),x("right")):i==="shell-nav"&&(console.log("Navigating shell-nav right"),O("right")),d=t):console.log("RIGHT navigation blocked - currently in shell surface:",y)),(l.justPressed("LB")||l.isDown("LB")&&t-d>I)&&(console.log("LB input detected"),i!=="shell-surface"?(i==="preview"?(console.log("Navigating apps left"),x("left")):i==="shell-nav"&&(console.log("Navigating shell-nav left"),O("left")),d=t):console.log("LB navigation blocked - currently in shell surface:",y)),(l.justPressed("RB")||l.isDown("RB")&&t-d>I)&&(console.log("RB input detected"),i!=="shell-surface"?(i==="preview"?(console.log("Navigating apps right"),x("right")):i==="shell-nav"&&(console.log("Navigating shell-nav right"),O("right")),d=t):console.log("RB navigation blocked - currently in shell surface:",y));const c=l.getStick("LEFT"),f=Date.now();c.magnitude>.6&&f-d>I&&(i==="library-launchers"?c.x>.6?(console.log("Left stick RIGHT - navigating launchers"),D("right"),d=f):c.x<-.6&&(console.log("Left stick LEFT - navigating launchers"),D("left"),d=f):i!=="shell-surface"?c.x>.6?(i==="preview"?x("right"):i==="shell-nav"&&O("right"),d=f):c.x<-.6&&(i==="preview"?x("left"):i==="shell-nav"&&O("left"),d=f):console.log("Stick navigation blocked - currently in shell surface:",y)),c.magnitude>.6&&f-d>I&&(i==="library-launchers"?c.y>.6?(console.log("Left stick UP - navigating launchers"),D("up"),d=f):c.y<-.6&&(console.log("Left stick DOWN - navigating launchers"),D("down"),d=f):i==="settings-nav"?c.y>.6?(console.log("Left stick UP - navigating settings"),W("up"),d=f):c.y<-.6&&(console.log("Left stick DOWN - navigating settings"),W("down"),d=f):i!=="shell-surface"?c.y>.6?(console.log("Analog stick UP detected - moving focus back to preview"),i==="shell-nav"&&(i="preview",b(),d=f)):c.y<-.6&&(console.log("Analog stick DOWN detected - moving focus to shell-nav"),i==="preview"&&(i="shell-nav",b(),d=f)):console.log("Analog stick vertical navigation blocked - currently in shell surface:",y)),(l.justPressed("DOWN")||l.isDown("DOWN")&&t-d>I)&&(i==="library-launchers"?(console.log("Navigating launchers down"),D("down"),d=t):i!=="shell-surface"?(console.log("DOWN input detected - moving focus to shell-nav"),i==="preview"&&(i="shell-nav",b(),d=t)):console.log("DOWN input blocked - currently in shell surface:",y)),(l.justPressed("UP")||l.isDown("UP")&&t-d>I)&&(i==="library-launchers"?(console.log("Navigating launchers up"),D("up"),d=t):i==="settings-nav"?(console.log("Navigating settings up"),W("up"),d=t):i!=="shell-surface"?(console.log("UP input detected - moving focus back to preview"),i==="shell-nav"&&(i="preview",b(),d=t)):console.log("UP input blocked - currently in shell surface:",y)),(l.justPressed("DOWN")||l.isDown("DOWN")&&t-d>I)&&i==="settings-nav"&&(console.log("Navigating settings down"),W("down"),d=t);const v=Date.now();if(l.isDown("A")&&v-ae>Ee&&(ae=v,i==="preview"?Ce():i==="shell-nav"?w===0?(console.log("Opening Library..."),Re(),u.confirmation()):w===1?(console.log("Opening Settings..."),Oe(),u.confirmation()):w===2?(console.log("Opening Notifications..."),He(),u.confirmation()):w===3&&(console.log("Opening Gallery..."),Fe(),u.confirmation()):i==="shell-surface"&&(console.log("A button pressed in shell surface:",y),u.lightTap())),l.justPressed("B")){const S=document.getElementById("shell-library"),A=document.getElementById("shell-settings"),ee=document.getElementById("shell-notifications"),te=document.getElementById("shell-gallery");console.log("B button pressed via InputManager"),S&&S.classList.contains("visible")?(console.log("Shell: B button - Closing Library"),xe(),u.lightTap()):A&&A.classList.contains("visible")?(console.log("Shell: B button - Closing Settings"),je(),u.lightTap()):ee&&ee.classList.contains("visible")?(console.log("Shell: B button - Closing Notifications"),Ue(),u.lightTap()):te&&te.classList.contains("visible")?(console.log("Shell: B button - Closing Gallery"),Ge(),u.lightTap()):(console.log("Shell: B button - Back/Cancel"),u.lightTap())}l.justPressed("Y")&&(console.log("Shell: Y button - Alternative action"),u.lightTap()),l.justPressed("LT")&&(console.log("Shell: LT - Previous app"),u.menuToggle()),l.justPressed("RT")&&(console.log("Shell: RT - Next app"),u.menuToggle());const m=l.getStick("RIGHT");m.magnitude>.3&&console.log(`Shell: Right stick scrolling - x:${m.x.toFixed(2)}, y:${m.y.toFixed(2)}`),l.justPressed("LS")&&(console.log("Shell: Left stick click - Quick action"),u.lightTap()),l.justPressed("RS")&&(console.log("Shell: Right stick click - Context menu"),u.lightTap()),l.justPressed("MENU")&&(console.log("Shell: Opening main menu"),G(p.MENU),u.menuToggle())}function Ye(){console.log("Menu inputs active - navigating menu system!"),l.justPressed("UP")&&(console.log("Menu: Navigate up"),u.selectionChange()),l.justPressed("DOWN")&&(console.log("Menu: Navigate down"),u.selectionChange()),l.justPressed("A")&&(console.log("Menu: Select item"),u.confirmation()),l.justPressed("B")&&(console.log("Menu: Back to shell"),G(p.SHELL),u.menuToggle()),l.justPressed("MENU")&&(console.log("Menu: Closing menu"),G(p.SHELL),u.menuToggle())}function We(){console.log("App inputs active - app-specific controls!"),l.justPressed("B")&&(console.log("App: Back to shell"),G(p.SHELL),u.lightTap())}requestAnimationFrame(ce);
